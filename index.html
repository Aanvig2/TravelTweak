<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Travel Chatbot</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@600;700&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/remixicon@2.5.0/fonts/remixicon.css">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap');
    @import url("https://fonts.googleapis.com/css2?family=Poppins:wght@400;500&display=swap");

    body {
        font-family: 'Inter', sans-serif;
        background-image: url("https://i.ibb.co/djd5kV6/bg.jpg"); 
        background-repeat: no-repeat;
        background-size: cover;
        margin: 0;
        padding: 0;
    }

    .intro-section {
        height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        text-align: center;
        color: #fff;
        padding: 20px;
        background-color: rgba(0, 0, 0, 0.5);
        position: relative;
    }

    .intro-section h1 {
        font-size: 2.5rem;
        margin-bottom: 20px;
    }

    .intro-section p {
        font-size: 1.2rem;
        max-width: 600px;
    }

    .intro-image {
        position: absolute;
        right: 50px;
        bottom: 0;
        max-width: 200px;
        z-index: 1;
    }

    .chat-container, .form {
        background-color: rgba(0,0,0, 0.2);
        border-radius: 15px;
        display: flex;
        flex-direction: column;
        margin: 20px auto;
    }

    /* Chatbot specific styles */
    .chat-container {
        width: 90vw;
        height: 90vh;
        max-width: 700px;
        max-height: 90vh;
        overflow: hidden;
        animation: fadeIn 1s ease-in-out;
    }

    .chat-header {
        display: flex;
        align-items: center; 
        color: #ffffff;
        padding: 20px;
        border-radius: 15px 15px 0 0;
        animation: slideIn 0.5s ease-in-out;
    }

    .user_img {
        height: 70px;
        width: 70px;
        margin-right: 10px;
        border: 1.5px solid #f5f6fa;
        border-radius: 100%;
    }

    .info span {
        font-size: 20px;
        font-weight: bold; 
    }

    .chat-body {
        padding: 20px;
        flex-grow: 1;
        overflow-y: auto;
        color: #ffffff;
        display: flex;
        flex-direction: column;
    }

    .message {
        margin-bottom: 15px;
        padding: 10px 15px;
        border-radius: 20px;
        max-width: 90%;
        opacity: 0;
        animation: fadeInMessage 0.8s ease forwards;
    }

    .user {
        background-color: #439b36;
        align-self: flex-end;
    }

    .bot {
        background-color: rgb(90, 145, 197);
        align-self: flex-start;
    }

    .chat-footer {
        display: flex;
        padding: 15px;
        border-top: 1px solid #ddd;
    }

    .input-message {
        flex-grow: 1;
        padding: 10px;
        border: none;
        border-radius: 10px;
        background-color: #c7c1c1;
        color: #000000;
    }

    .send-btn {
        background-color: #c7c1c1;
        border: none;
        padding: 10px 16px;
        margin-left: 10px;
        border-radius: 8px;
        cursor: pointer;
    }

    .form {
        background-color: hsla(0, 0%, 10%, 0.1);
        border: 2px solid var(--white-color);
        padding: 2.5rem 1.5rem;
        border-radius: 1rem;
    }

    .content {
        row-gap: 1.75rem;
    }

    .input {
        width: 100%;
        padding-block: 0.8rem;
        background: none;
        color: #ffffff;
    }

    .button {
        width: 100%;
        padding: 1rem;
        background-color: #fff;
        cursor: pointer;
    }

    .why-choose-us-section {
        display: flex;
        justify-content: space-between;
        padding: 40px;
        background-color: #f7f9fa;
    }

    .why-choose-us-section .content {
        width: 50%;
        padding-right: 20px;
    }

    .why-choose-us-section .image-container {
        width: 50%;
        display: flex;
        justify-content: flex-start;
        align-items: center;
    }

    .why-choose-us-section img {
        max-width: 300px;
    }
    .footer-image {
        width: 100%;
        height: auto;
    }

    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    @keyframes slideIn { from { transform: translateY(-100%); } to { transform: translateY(0); } }
    @keyframes fadeInMessage { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
  </style>
</head>
<body>
<div id="login-section" class="page">
    <img src="LR-bg.jpg" class="img">
    <form class="form">
        <h1 class="title">Login</h1>
        <div class="content">
            <div class="box">
                <i class="ri-user-3-line icon"></i>
                <div class="box-input">
                    <input type="email" required class="input" id="email" placeholder=" ">
                    <label for="email" class="label">Email</label>
                </div>
            </div>
            <div class="box">
                <i class="ri-lock-2-line icon"></i>
                <div class="box-input">
                    <input type="password" required class="input" id="pass" placeholder=" ">
                    <label for="pass" class="label">Password</label>
                    <i class="ri-eye-off-line eye" id="eye"></i>
                </div>
            </div>
        </div>
        <button type="button" class="button" onclick="startChat()">Login</button>
        <p class="x">Don't have an account? <a href="#">Register</a></p>
    </form>
</div>

<div id="chat-section" style="display:none;">
    <nav class="navbar navbar-expand-lg bg-body-tertiary border-bottom">
      <div class="container-fluid">
        <a class="navbar-brand" href="#">Travel Tweak</a>
      </div>
    </nav>

    <!-- Intro Section -->
<div class="intro-section">
    <div>
        <h1>Start your journey with our one-stop travel solution!</h1>
        <p>Plan and book your perfect trip with TravelTweak's intelligent chatbot. Get expert advice, tailored itineraries, and dynamic trip suggestions - all in one click!</p>
        <button class="btn btn-light">Scroll down to chat</button>
    </div>
    <img src="https://i.ibb.co/Nj6HSpy/image.png" alt="Travel Image" class="intro-image">
</div>

<div class="why-choose-us-section">
</div>
    <div class="image-container">
        <img src="https://i.ibb.co/KNrjyj2/image.png" alt="Why Choose Us Image">
    </div>
    <div class="content">
        <h2>Why Choose Us</h2>
        <p>Enjoy different experiences in every place you visit and discover new and affordable adventures of course.</p>
        <ul>
            <li>Flight Ticket: Vitae donec pellentesque a aliquam et ultricies auctor.</li>
            <li>Accommodation: Vitae donec pellentesque a aliquam et ultricies auctor.</li>
        </ul>
    </div>
</div>
    <div id="chat" style="padding: 20px;">
        <div class="chat-container">
            <div class="chat-header">
                <img src="https://i.ibb.co/fSNP7Rz/icons8-chatgpt-512.png" class="user_img">
                <div class="info">
                    <span>TravelTweak</span>
                    <p>Tailoring your trips just the way you like!</p>
                </div>
            </div>

            <div class="chat-body" id="chatBody"></div>

            <div class="chat-footer">
                <input type="text" id="messageInput" class="input-message" placeholder="Type your message here...">
                <button class="send-btn" onclick="sendMessage()">Send</button>
            </div>
        </div>
    </div>
</div>

<img src="https://i.ibb.co/fYckks9/image.png" alt="Footer Image" class="footer-image">

<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script>
    const loginSection = document.getElementById('login-section');
    const chatSection = document.getElementById('chat-section');
    const chatBody = document.getElementById('chatBody');
    const messageInput = document.getElementById('messageInput');

    function startChat() {
        loginSection.style.display = 'none';
        chatSection.style.display = 'block';
        appendMessage(tripQuestions[currentQuestionIndex], 'bot'); // Start with the first question
    }

    const LLAMA_API_URL = "https://phi.us.gaianet.network/v1/chat/completions";
    const tripQuestions = [
        "What is your destination?",
        "What type of vacation are you looking for?",
        "What kind of weather do you prefer?",
        "How many days are you planning for?",
        "What is your budget?",
        "Can you describe your ideal vacation in a few words?",
        "What is your preferred mode of travel to the destination?",
        "How do you plan to get around the destination?",
        "How many people are traveling?",
        "What type of accommodation do you prefer?",
        "Any special interests or activities you want to focus on?",
        "Any dietary preferences or restrictions?"
    ];

    const responseKeys = [
        'destinationAnswer',
        'vacationTypeAnswer',
        'weatherAnswer',
        'daysAnswer',
        'budgetAnswer',
        'idealVacationAnswer',
        'travelModeAnswer',
        'localTravelAnswer',
        'numberOfPeopleAnswer',
        'accommodationAnswer',
        'interestAnswer',
        'dietAnswer'
    ];

    let userResponses = {};
    let currentQuestionIndex = 0;

    // Append a message to the chat
    function appendMessage(message, sender) {
        const messageElement = document.createElement('div');
        messageElement.classList.add('message', sender);
        messageElement.innerHTML = message;
        chatBody.appendChild(messageElement);
        chatBody.scrollTop = chatBody.scrollHeight; // Scroll to the bottom after each message
    }

    // Compile the final trip plan and send it to the Llama API
    async function compileAndSendTripPlan() {
        const compiledInfo = `
        You are a trip planning expert who prepares a day-to-day itinerary of the trip for the user. Your answering format should follow this template:
        Date: "Provide the date"
        Hotel Recommendation: "Provide hotel recommendation"
        Morning:
          Time: "Provide time"
          Activity: "Provide activity"
        Afternoon:
          Time: "Provide time"
          Activity: "Provide activity"
        Evening:
          Time: "Provide time"
          Activity: "Provide activity"
        A person wants to go to "${userResponses.destinationAnswer}" and have a "${userResponses.vacationTypeAnswer}" type of vacation. Plan the trip when the weather is "${userResponses.weatherAnswer}" and make it "${userResponses.daysAnswer}" days long. The budget is "${userResponses.budgetAnswer}" INR. This person is looking for an experience like this: "${userResponses.idealVacationAnswer}". The preferred mode of travel to the destination is "${userResponses.travelModeAnswer}" and preferred mode of local travel to go around the destination is "${userResponses.localTravelAnswer}". "${userResponses.numberOfPeopleAnswer}" people are going on the trip.
        Give recommendations for "${userResponses.accommodationAnswer}" type of accommodation at the destination. Include some "${userResponses.interestAnswer}" in the day-to-day trip plan. The places to eat should follow their preferences: "${userResponses.dietAnswer}".
        `;

        try {
            const response = await fetch(LLAMA_API_URL, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    messages: [
                        { role: "system", content: "You are a helpful assistant." },
                        { role: "user", content: compiledInfo }
                    ]
                })
            });

            const data = await response.json();
            formatBotResponse(data.choices[0].message.content.trim());
        } catch (error) {
            appendMessage("Error generating the trip plan. Please try again.", 'bot');
        }
    }
        // Format bot's response
    function formatBotResponse(aiResponse) {
        let formattedResponse = aiResponse
            .replace(/\*\*/g, '<br>')
            .replace(/###/g, '<br>')
            .replace(/####/g, '<br>');
        formattedResponse = formattedResponse.replace(/(Date:\s[\w\s,]+)/g, '<b>$1</b><br>');
        formattedResponse = formattedResponse
            .replace(/\b(Morning|Afternoon|Evening|Day)\b/g, '<br><b>$1</b>')
            .replace(/Time:/g, '<br>Time:')
            .replace(/Activity:/g, '<br>Activity:');
        formattedResponse = formattedResponse.replace(/\*(.*?)\*/g, '<i>$1</i>');

        appendMessage(formattedResponse, 'bot');
    }
    // Handle sending a message
    function sendMessage() {
        const userMessage = messageInput.value.trim();

        if (userMessage === '') return;

        // Append the user's message
        appendMessage(userMessage, 'user');

        // Store the response for the current question
        if (currentQuestionIndex < tripQuestions.length) {
            userResponses[responseKeys[currentQuestionIndex]] = userMessage;
            currentQuestionIndex++;

            // Ask the next question or compile and send the trip plan
            if (currentQuestionIndex < tripQuestions.length) {
                setTimeout(() => {
                    appendMessage(tripQuestions[currentQuestionIndex], 'bot');
                }, 500);
            } else {
                compileAndSendTripPlan();
            }
        }

        messageInput.value = ''; // Clear the input field
    }
    
    // Add event listener for sending a message with the Enter key
    messageInput.addEventListener('keydown', (event) => {
        if (event.key === 'Enter') {
            sendMessage();
        }
    });
</script>
</body>
</html>
